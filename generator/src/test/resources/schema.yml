openapi: 3.0.1
info:
  title: OpenAPI definition
  version: v0.1
servers:
  - url: 'https://api-staging.rarible.com/protocol/v0.1'
    description: Staging environment (rinkeby)
  - url: 'https://api.rarible.com/protocol/v0.1'
    description: Production environment (mainnet)
paths:

  ########### Orders ###########

  /ethereum/order/orders:
    post:
      tags:
        - order-controller
      description: Create or update Order
      operationId: createOrUpdateOrder
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/OrderForm'
        required: true
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Order'
        '500':
          description: Internal Server Error
          content:
            '*/*':
              schema:
                $ref: '#/components/schemas/IndexerApiError'

  /ethereum/order/encoder/data:
    post:
      tags:
        - encode-controller
      description: Encode OrderData
      operationId: encodeOrderData
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/OrderData'
        required: true
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/EncodedData'
        '500':
          description: Internal Server Error
          content:
            '*/*':
              schema:
                $ref: '#/components/schemas/IndexerApiError'
  /ethereum/order/encoder/assetType:
    post:
      tags:
        - encode-controller
      description: Encode AssetType
      operationId: encodeAssetType
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/AssetType'
        required: true
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/EncodedData'
        '500':
          description: Internal Server Error
          content:
            '*/*':
              schema:
                $ref: '#/components/schemas/IndexerApiError'

  '/ethereum/order/orders/{hash}':
    get:
      tags:
        - order-controller
      operationId: getOrderByHash
      description: Get order by hash
      parameters:
        - name: hash
          in: path
          required: true
          schema:
            type: string
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Order'
        '500':
          description: Internal Server Error
          content:
            '*/*':
              schema:
                $ref: '#/components/schemas/IndexerApiError'
  /ethereum/order/orders/sell/byMaker:
    get:
      tags:
        - order-controller
      operationId: getSellOrdersByMaker
      parameters:
        - name: maker
          in: query
          required: true
          schema:
            $ref: '#/components/schemas/Address'
        - name: origin
          in: query
          required: false
          schema:
            $ref: '#/components/schemas/Address'
        - name: sort
          in: query
          required: false
          schema:
            type: string
            enum:
              - LAST_UPDATE
        - name: continuation
          in: query
          required: false
          schema:
            type: string
        - name: size
          in: query
          required: false
          schema:
            minimum: 1
            type: integer
            format: int32
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/OrdersPagination'
        '500':
          description: Internal Server Error
          content:
            '*/*':
              schema:
                $ref: '#/components/schemas/IndexerApiError'
  /ethereum/order/orders/sell/byItem:
    get:
      tags:
        - order-controller
      operationId: getSellOrdersByItem
      parameters:
        - name: contract
          in: query
          required: true
          schema:
            $ref: '#/components/schemas/Address'
        - name: tokenId
          in: query
          required: true
          schema:
            $ref: '#/components/schemas/BigInt'
        - name: origin
          in: query
          required: false
          schema:
            $ref: '#/components/schemas/Address'
        - name: sort
          in: query
          required: false
          schema:
            type: string
            enum:
              - LAST_UPDATE
        - name: continuation
          in: query
          required: false
          schema:
            type: string
        - name: size
          in: query
          required: false
          schema:
            minimum: 1
            type: integer
            format: int32
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/OrdersPagination'
        '500':
          description: Internal Server Error
          content:
            '*/*':
              schema:
                $ref: '#/components/schemas/IndexerApiError'
  /ethereum/order/orders/sell/byCollection:
    get:
      tags:
        - order-controller
      operationId: getSellOrdersByCollection
      parameters:
        - name: collection
          in: query
          required: true
          schema:
            $ref: '#/components/schemas/Address'
        - name: origin
          in: query
          required: false
          schema:
            $ref: '#/components/schemas/Address'
        - name: sort
          in: query
          required: false
          schema:
            type: string
            enum:
              - LAST_UPDATE
        - name: continuation
          in: query
          required: false
          schema:
            type: string
        - name: size
          in: query
          required: false
          schema:
            minimum: 1
            type: integer
            format: int32
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/OrdersPagination'
        '500':
          description: Internal Server Error
          content:
            '*/*':
              schema:
                $ref: '#/components/schemas/IndexerApiError'
  /ethereum/order/orders/sell:
    get:
      tags:
        - order-controller
      operationId: getSellOrders
      parameters:
        - name: origin
          in: query
          required: false
          schema:
            $ref: '#/components/schemas/Address'
        - name: sort
          in: query
          required: false
          schema:
            type: string
            enum:
              - LAST_UPDATE
        - name: continuation
          in: query
          required: false
          schema:
            type: string
        - name: size
          in: query
          required: false
          schema:
            minimum: 1
            type: integer
            format: int32
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/OrdersPagination'
        '500':
          description: Internal Server Error
          content:
            '*/*':
              schema:
                $ref: '#/components/schemas/IndexerApiError'
  /ethereum/order/orders/bids/byMaker:
    get:
      tags:
        - order-controller
      operationId: getBidsByMaker
      parameters:
        - name: maker
          in: query
          required: true
          schema:
            $ref: '#/components/schemas/Address'
        - name: origin
          in: query
          required: false
          schema:
            $ref: '#/components/schemas/Address'
        - name: sort
          in: query
          required: false
          schema:
            type: string
            enum:
              - LAST_UPDATE
        - name: continuation
          in: query
          required: false
          schema:
            type: string
        - name: size
          in: query
          required: false
          schema:
            minimum: 1
            type: integer
            format: int32
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/OrdersPagination'
        '500':
          description: Internal Server Error
          content:
            '*/*':
              schema:
                $ref: '#/components/schemas/IndexerApiError'
  /ethereum/order/orders/bids/byItem:
    get:
      tags:
        - order-controller
      operationId: getBidsByItem
      parameters:
        - name: contract
          in: query
          required: true
          schema:
            $ref: '#/components/schemas/Address'
        - name: tokenId
          in: query
          required: true
          schema:
            $ref: '#/components/schemas/BigInt'
        - name: origin
          in: query
          required: false
          schema:
            $ref: '#/components/schemas/Address'
        - name: sort
          in: query
          required: false
          schema:
            type: string
            enum:
              - LAST_UPDATE
        - name: continuation
          in: query
          required: false
          schema:
            type: string
        - name: size
          in: query
          required: false
          schema:
            minimum: 1
            type: integer
            format: int32
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/OrdersPagination'
        '500':
          description: Internal Server Error
          content:
            '*/*':
              schema:
                $ref: '#/components/schemas/IndexerApiError'

  ########### Items ###########
  '/ethereum/nft/items/{itemId}':
    get:
      tags:
        - item-controller
      description: returns Item by identifier
      operationId: getItemById
      parameters:
        - name: itemId
          in: path
          required: true
          schema:
            $ref: '#/components/schemas/ItemId'
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Item'
        '500':
          description: Internal Server Error
          content:
            '*/*':
              schema:
                $ref: '#/components/schemas/IndexerApiError'

  '/ethereum/nft/items/{itemId}/meta':
    get:
      tags:
        - item-controller
      operationId: getItemMetaById
      description: Get Item meta information
      parameters:
        - name: itemId
          in: path
          required: true
          schema:
            $ref: '#/components/schemas/ItemId'
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ItemMeta'
        '500':
          description: Internal Server Error
          content:
            '*/*':
              schema:
                $ref: '#/components/schemas/IndexerApiError'

  /ethereum/nft/items/all:
    get:
      tags:
        - item-controller
      operationId: getAllItems
      description: Get all items
      parameters:
        - name: continuation
          in: query
          required: false
          schema:
            type: string
        - name: size
          in: query
          required: false
          schema:
            type: integer
            format: int32
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Items'
        '500':
          description: Internal Server Error
          content:
            '*/*':
              schema:
                $ref: '#/components/schemas/IndexerApiError'
  /ethereum/nft/items/byOwner:
    get:
      tags:
        - item-controller
      operationId: getItemsByOwner
      description: Get all items owned by an address
      parameters:
        - name: owner
          in: query
          required: true
          schema:
            $ref: '#/components/schemas/Address'
        - name: continuation
          in: query
          required: false
          schema:
            type: string
        - name: size
          in: query
          required: false
          schema:
            type: integer
            format: int32
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Items'
        '500':
          description: Internal Server Error
          content:
            '*/*':
              schema:
                $ref: '#/components/schemas/IndexerApiError'
  /ethereum/nft/items/byCreator:
    get:
      tags:
        - item-controller
      operationId: getItemsByCreator
      description: Get all items created by specific address
      parameters:
        - name: creator
          in: query
          required: true
          schema:
            $ref: '#/components/schemas/Address'
        - name: continuation
          in: query
          required: false
          schema:
            type: string
        - name: size
          in: query
          required: false
          schema:
            type: integer
            format: int32
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Items'
        '500':
          description: Internal Server Error
          content:
            '*/*':
              schema:
                $ref: '#/components/schemas/IndexerApiError'
  /ethereum/nft/items/byCollection:
    get:
      tags:
        - item-controller
      operationId: getItemsByCollection
      description: Get all items in specific collection
      parameters:
        - name: collection
          in: query
          required: true
          schema:
            $ref: '#/components/schemas/Address'
        - name: continuation
          in: query
          required: false
          schema:
            type: string
        - name: size
          in: query
          required: false
          schema:
            type: integer
            format: int32
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Items'
        '500':
          description: Internal Server Error
          content:
            '*/*':
              schema:
                $ref: '#/components/schemas/IndexerApiError'

  ########### Lazy-mint ###########
  /ethereum/nft/mints:
    post:
      tags:
        - lazy-mint-controller
      description: Create lazy-minted NFT
      operationId: createLazyMint
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/LazyItem'
        required: true
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Item'
        '500':
          description: Internal Server Error
          content:
            '*/*':
              schema:
                $ref: '#/components/schemas/IndexerApiError'

  '/ethereum/nft/items/{itemId}/lazy':
    get:
      tags:
        - lazy-mint-controller
      operationId: getLazyItemById
      description: Get information about lazy-minted NFT
      parameters:
        - name: itemId
          in: path
          required: true
          schema:
            type: string
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/LazyItem'
        '500':
          description: Internal Server Error
          content:
            '*/*':
              schema:
                $ref: '#/components/schemas/IndexerApiError'

  ########### Ownerships ###########
  '/ethereum/nft/ownerships/{ownershipId}':
    get:
      tags:
        - ownership-controller
      operationId: getOwnershipById
      parameters:
        - name: ownershipId
          in: path
          required: true
          schema:
            $ref: '#/components/schemas/OwnershipId'
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Ownership'
        '500':
          description: Internal Server Error
          content:
            '*/*':
              schema:
                $ref: '#/components/schemas/IndexerApiError'

  /ethereum/nft/ownerships/byItem:
    get:
      tags:
        - ownership-controller
      operationId: getOwnershipsByItem
      description: Get all ownerships (owners and value owned by them) for specific Item
      parameters:
        - name: contract
          in: query
          required: true
          schema:
            $ref: '#/components/schemas/Address'
        - name: tokenId
          in: query
          required: true
          schema:
            type: string
        - name: continuation
          in: query
          required: false
          schema:
            type: string
        - name: size
          in: query
          required: false
          schema:
            type: integer
            format: int32
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Ownerships'
        '500':
          description: Internal Server Error
          content:
            '*/*':
              schema:
                $ref: '#/components/schemas/IndexerApiError'

  ########### Collections ###########
  '/ethereum/nft/collections/{collection}':
    get:
      tags:
        - collection-controller
      description: Returns Collection by address
      operationId: getCollectionById
      parameters:
        - name: collection
          in: path
          required: true
          schema:
            type: string
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Collection'
        '500':
          description: Internal Server Error
          content:
            '*/*':
              schema:
                $ref: '#/components/schemas/IndexerApiError'

  '/ethereum/nft/collections/{collection}/generate_token_id':
    get:
      tags:
        - collection-controller
      description: Returns next available tokenId for minter
      operationId: generateTokenId
      parameters:
        - name: collection
          in: path
          description: collection address
          required: true
          schema:
            $ref: '#/components/schemas/Address'
        - name: minter
          in: query
          description: minter address
          required: true
          schema:
            $ref: '#/components/schemas/Address'
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/TokenId'
        '500':
          description: Internal Server Error
          content:
            '*/*':
              schema:
                $ref: '#/components/schemas/IndexerApiError'

components:
  schemas:

    LazyItem:
      description: Lazy NFT (ERC-721 or ERC-1155)
      oneOf:
        - $ref: '#/components/schemas/LazyErc1155'
        - $ref: '#/components/schemas/LazyErc721'

    LazyErc721:
      required:
        - creators
        - royalties
        - signatures
        - contract
        - tokenId
        - uri
        - '@type'
      type: object
      properties:
        '@type':
          type: string
          enum:
            - ERC721
        contract:
          $ref: '#/components/schemas/Address'
        tokenId:
          $ref: '#/components/schemas/BigInt'
        uri:
          type: string
        creators:
          type: array
          items:
            $ref: '#/components/schemas/Part'
        royalties:
          type: array
          items:
            $ref: '#/components/schemas/Part'

    LazyErc1155:
      required:
        - creators
        - royalties
        - signatures
        - supply
        - contract
        - tokenId
        - uri
        - '@type'
      type: object
      properties:
        '@type':
          type: string
          enum:
            - ERC1155
        contract:
          $ref: '#/components/schemas/Address'
        tokenId:
          $ref: '#/components/schemas/BigInt'
        uri:
          type: string
        supply:
          $ref: '#/components/schemas/BigInt'
        creators:
          type: array
          items:
            $ref: '#/components/schemas/Part'
        royalties:
          type: array
          items:
            $ref: '#/components/schemas/Part'
        testPart:
          $ref: '#/components/schemas/Part'

    Part:
      required:
        - account
        - value
      type: object
      properties:
        account:
          $ref: '#/components/schemas/Address'
        value:
          type: integer
      example:
        account: '0x60f80121c31a0d46b5279700f9df786054aa5ee5'
        value: 300

    Address:
      type: string
      example: '0x60f80121c31a0d46b5279700f9df786054aa5ee5'

    BigInt:
      type: string
      example: 717802
